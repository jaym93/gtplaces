--- memcache_pool.h.orig	2009-03-15 12:02:52.000000000 +0200
+++ memcache_pool.h	2009-03-15 12:01:48.000000000 +0200
@@ -25,6 +25,14 @@
 #include "config.h"
 #endif
 
+#ifdef HAVE_SYS_TYPES_H
+#include <sys/types.h>
+#endif
+
+#ifdef HAVE_SYS_SOCKET_H
+#include <sys/socket.h>
+#endif
+
 #include <stdint.h>
 #include <string.h>
 
@@ -40,6 +48,15 @@
 #define ZSTR_VAL(v) (v).s
 #endif
 
+/*
+ * Mac OS X has no MSG_NOSIGNAL but >= 10.2 comes with SO_NOSIGPIPE which is a setsockopt() option
+ * and not a send() parameter as MSG_NOSIGNAL. OpenBSD has none of the options so we need to ignore 
+ * SIGPIPE events
+ */
+#ifndef MSG_NOSIGNAL
+#define MSG_NOSIGNAL 0
+#endif /*MSG_NOSIGNAL*/
+
 /* use lowest byte for flags */
 #define MMC_SERIALIZED	0x0001
 #define MMC_COMPRESSED	0x0002
